function mozLive3(e){this.options=$.extend(!0,{},this.defaults,e),this.run()}function mozLive2(e){var o=this;return this.defaults={source:null,action:"",parameters:{},response:{callback:[],append:[],replace:[],html:[],redirect:null},errors:{maintenance:"We can not process your request right now. Please try again later."}},this.resolveObject=function(e){var t=null;return"@self"==e&&(e=o.options.source),void 0!==e.id?t=$('[data-cid="'+e.id+'"]'):void 0!==e.name&&(t=$('[data-name="'+e.name+'"]')),t},this.run=function(){$.ajax({url:"/m/mozlive/",type:"post",data:{src:o.options.source,action:o.options.action,parameters:o.options.parameters,url:window.location.pathname},success:function(e){1==e.error?"maintenance"==e.reason&&alert(o.options.errors.maintenance):(o.respond(e),"function"==typeof o.options.onComplete&&o.options.onComplete(e))}})},this.respond=function(e){if($.isArray(o.options.response.callback)&&o.options.response.callback.forEach((function(o,t){o(e)})),$.isArray(o.options.response.append)&&o.options.response.append.forEach((function(t,n){var r=o.resolveObject(t);r&&r.append(e)})),$.isArray(o.options.response.replace)&&o.options.response.replace.forEach((function(t,n){var r=o.resolveObject(t);r&&("string"==typeof t.target?r.find(t.target).replaceWith(e):r.replaceWith(e))})),$.isArray(o.options.response.html)&&o.options.response.html.forEach((function(t,n){var r=o.resolveObject(t);r&&("string"==typeof t.target?r.find(t.target).html(e):r.html(e))})),"string"==typeof o.options.response.redirect){var t="";switch(o.options.response.redirect){case"@response":t=e;break;case"@refresh":t="/m/refresh/";break;default:t=o.options.response.redirect}window.location.href=t}},this.options=$.extend({},this.defaults,e),this.run(),!1}function mozLive(e){var o=this;return o.defaults={src:null,dest:"self",action:"",task:"replace",tasktarget:null,parameters:{},errors:{maintenance:"We can not process your request right now. Please try again later."},onComplete:function(){}},o.processResult=function(e){if(void 0!==o.options.parameters.callback&&o.options.parameters.callback(e),"refresh"!==o.options.task)if("redirect"!==o.options.task)if("redirect-response"!=o.options.task){if("replace-html"==o.options.task){var t=document.open("text/html");return t.write(e),void t.close()}var n=null,r=null;if(null!==o.options.dest&&"self"!==o.options.dest&&(n=o.options.dest),"self"===o.options.dest&&(n=o.options.src),null!=n&&(void 0!==n.id?r=$('[data-cid="'+n.id+'"]'):void 0!==n.name&&(r=$('[data-name="'+n.name+'"]'))),null!=r)switch(o.options.task){case"replace":null==o.options.tasktarget?$(r).replaceWith(e):$(r).find(o.options.tasktarget).replaceWith(e);break;case"append":$(r).append(e)}}else window.location.href=e;else void 0!==o.options.parameters.href&&(window.location.href=o.options.parameters.href);else window.location.href="/m/refresh/"},o.run=function(){var e=this;$.ajax({url:"/m/mozlive/"+e.options.action+"/",type:"post",data:{action:e.options.action,url:window.location.pathname,src:e.options.src,parameters:e.options.parameters},success:function(o){1==o.error?"maintenance"==o.reason&&e.options.errors&&e.options.errors.maintenance&&alert(e.options.errors.maintenance):(e.processResult(o),"function"==typeof e.options.onComplete&&e.options.onComplete(o))}})},o.options=$.extend({},this.defaults,e),o.run(),!1}mozLive3.prototype.resolveObject=function(e){var o=null;return"@self"==e&&(e=this.options.source),void 0!==e.id?o=$('[data-cid="'+e.id+'"]'):void 0!==e.name?o=$('[data-name="'+e.name+'"]'):void 0!==e.jquery&&(o=$(e.jquery)),o},mozLive3.prototype.respond=function(e){var o=this;if($.isArray(o.options.response.callback)&&o.options.response.callback.forEach((function(o,t){o(e)})),$.isArray(o.options.response.append)&&o.options.response.append.forEach((function(t,n){var r=o.resolveObject(t);r&&r.append(e)})),$.isArray(o.options.response.replace)&&o.options.response.replace.forEach((function(t,n){var r=o.resolveObject(t);r&&("string"==typeof t.target?r.find(t.target).replaceWith(e):r.replaceWith(e))})),$.isArray(o.options.response.html)&&o.options.response.html.forEach((function(t,n){var r=o.resolveObject(t);r&&("string"==typeof t.target?r.find(t.target).html(e):r.html(e))})),"string"==typeof o.options.response.redirect){var t="";switch(o.options.response.redirect){case"@response":t=e;break;case"@refresh":t="/m/refresh/";break;default:t=o.options.response.redirect}window.location.href=t}},mozLive3.prototype.run=function(){var e=this;$.ajax({url:"/m/mozlive/"+e.options.action+"/",type:"post",data:{src:e.options.source,action:e.options.action,parameters:e.options.parameters,url:window.location.pathname},success:function(o){1==o.error?"maintenance"==o.reason&&e.options.errors&&e.options.errors.maintenance&&alert(e.options.errors.maintenance):(e.respond(o),"function"==typeof e.options.onComplete&&e.options.onComplete(o))}})};